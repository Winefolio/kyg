# P1-002: Open Redirect Vulnerability in Login.tsx

## Priority: CRITICAL (P1)
## Status: Open
## Category: Security

## Summary
The `redirectTo` query parameter in Login.tsx is used without validation, allowing attackers to redirect users to malicious sites after login.

## Affected Files
- `client/src/pages/Login.tsx:22, 50, 64`

## Vulnerable Code
```typescript
const redirectTo = new URLSearchParams(search).get("redirect");
// ...
const destination = redirectTo || '/home';
setLocation(destination);
```

## Attack Vector
```
https://cata.wine/login?redirect=https://evil.com/phishing
```
User logs in legitimately, then gets redirected to attacker's site.

## Fix Required
```typescript
const validateRedirect = (url: string | null): string => {
  if (!url) return '/home';
  // Only allow relative paths starting with /
  if (url.startsWith('/') && !url.startsWith('//')) {
    return url;
  }
  return '/home';
};

const redirectTo = validateRedirect(new URLSearchParams(search).get("redirect"));
```

## Risk if Not Fixed
- Phishing attacks using legitimate login flow
- Credential theft via lookalike sites
- OWASP Top 10: A01:2021 - Broken Access Control

## Found By
Security Sentinel Agent
